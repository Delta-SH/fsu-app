"use strict";loader.define(function(i,t,n){var s={name:"实时数据",request:null,areas:null,stations:null,refkeys:null,search:null,accordion:null,accordior:null};function a(i,t){var a="";0<i.length?($.each(i,function(i,n){a+='\n          <dt id="pylon-data-area-'.concat(n.ID,'" class="bui-btn bui-box">\n            <div class="span1">').concat(n.Name,'</div>\n            <i class="icon-accordion"></i>\n          </dt>\n          <dd><ul class="bui-list accordion-details">\n        '),$.each(t,function(i,t){t.PID===n.ID&&(a+='\n              <li id="pylon-data-station-'.concat(t.ID,'" class="bui-btn bui-box" href="pages/main/station.html?id=').concat(t.ID,'">\n                <div class="bui-icon round success"><i class="appiconfont appicon-station"></i></div>\n                <div class="span1">').concat(t.Name,' <span class="bui-badges hidden">0</span></div>\n                <i class="icon-listright"></i>\n              </li>\n              '))}),a+="</ul></dd>"}),s.accordior.html(a),s.accordion.init(),s.accordion.showFirst()):(a+='<ul class="bui-list">',$.each(t,function(i,t){a+='\n              <li id="pylon-data-station-'.concat(t.ID,'" class="bui-btn bui-box" href="pages/main/station.html?id=').concat(t.ID,'">\n                <div class="bui-icon round success"><i class="appiconfont appicon-station"></i></div>\n                <div class="span1">').concat(t.Name,' <span class="bui-badges hidden">0</span></div>\n                <i class="icon-listright"></i>\n              </li>\n              ')}),a+='</ul><div class="nomore">没有更多内容</div>',s.accordior.html(a))}return s.init=function(){var i,t,n;!0===isNull(this.request)&&(this.request=getAppRequest()),!0===isNull(this.search)&&(this.search=bui.searchbar({id:"#pylon-app-data-search",onInput:function(){},onRemove:function(i,t){s.filter(t)},callback:function(i,t){s.filter(t)}})),!0===isNull(this.accordior)&&(this.areas=getAreas(),this.stations=getStations(),this.accordior=router.$("#pylon-app-data-accordion"),this.refkeys=this.stations.map(function(i,t,n){return i.ID})),!0===isNull(this.accordion)&&0<this.areas.length&&(this.accordion=bui.accordion({id:"#pylon-app-data-accordion",single:!0})),a(this.areas,this.stations),i=router.$("#app-main-tab-data").height(),t=router.$("header").height(),n=router.$("#pylon-app-data-search").height(),router.$(".data-list-container").height(i-t-n)},s.load=function(){this.refresh()},s.dispose=function(){},s.refresh=function(){!0!==isNull(this.refkeys)&&0!==this.refkeys.length&&this.request.Post({url:"GetNodeStates",data:{id:this.refkeys}},function(i){$.each(i.data,function(i,t){var n=router.$(String.format("#pylon-data-station-{0}",t.ID)),a=n.children(".bui-icon"),s=n.find(".span1 > .bui-badges");a.attr("class",String.format("bui-icon round {0}",getStateCls2(t.State))),s.html(t.AlarmCount),0<t.AlarmCount?s.show():s.hide()})},function(i){warning(i)})},s.filter=function(t){if(!0===isNullOrEmpty(t,!0))this.refkeys=this.stations.map(function(i,t,n){return i.ID}),a(this.areas,this.stations),this.refresh();else{t=t.toLowerCase();var i=this.stations.filter(function(i){return-1<i.Name.toLowerCase().indexOf(t)});0==i.length?this.accordior.html('<div class="nodata"><i class="appiconfont appicon-empty-face"></i> <span>列表空空如也~</span></div>'):(this.refkeys=i.map(function(i,t,n){return i.ID}),a([],i),this.refresh())}},s.init(),s.load(),s});
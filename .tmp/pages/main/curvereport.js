"use strict";loader.define(function(e,t,i){var u={name:"测值曲线",request:null,loading:null,deviceer:null,deviceor:null,signaler:null,starter:null,ender:null,submit:null,nodes:null};function o(e){!0!==isNull(e)?(u.loading.show(),getAllSignalsByPid(e,null,function(e){n(e)},function(e){warning(e.message)},function(){u.loading.hide()})):n([])}function n(e){var i=[],n=[];$.each(e,function(e,t){t.Type===$node.AI.id&&(n.push(t),i.push({name:t.Name,value:t.ID}))}),u.nodes=n,u.signaler.option("data",i),u.signaler.selectNone()}function l(e){var t=u.signaler.value();if(!0===isNullOrEmpty(t))return warning("请选择信号哦"),e.stop(),!1;var i=parseInt(t),n=u.nodes.filter(function(e){return e.ID===i});if(n.length<=0)return warning("无效的信号~"),e.stop(),!1;var l=u.starter.value(),a=u.ender.value();return!0===isNullOrEmpty(l)?(warning("请选择开始时间"),e.stop(),!1):!0===isNullOrEmpty(a)?(warning("请选择结束时间"),e.stop(),!1):(e.stop(),void router.load({url:"pages/main/curvedetail.html",param:{id:n[0].ID,name:n[0].Name,desc:n[0].ValueDesc,begin:l,end:a}}))}return u.init=function(){!0===isNull(this.request)&&(this.request=getAppRequest()),!0===isNull(this.loading)&&(this.loading=bui.loading({appendTo:".curvereport-page",text:"正在加载"})),!0===isNull(this.deviceer)&&(u.loading.show(),getXDevices(null,function(e){!function(e){if(getAppAuthType()===$ssh.Station){for(var t=getStations(),n=[],l={},i=0;i<t.length;i++){var a=t[i];l[a.ID]={d:a.ID,n:a.Name,c:[]}}$.each(e,function(e,t){var i=l[t.PID];i&&i.c.push({d:t.ID,n:t.Name})}),$.each(t,function(e,t){var i=l[t.ID];i&&n.push(i)}),router.$("#pylon-app-curvereport-deviceer .selector").html('<div class="selected-val"></div><div class="selected-val"></div>'),u.deviceer=bui.levelselect({data:n,title:"筛选范围",trigger:"#pylon-app-curvereport-deviceer .selected-val",level:2,field:{name:"n",value:"d",data:["c","a"]}})}else{var r=getAreas(),s=(t=getStations(),n=[],{});for(l={},i=0;i<r.length;i++){a=r[i];s[a.ID]={d:a.ID,n:a.Name,c:[]}}for(i=0;i<t.length;i++){a=t[i];l[a.ID]={d:a.ID,n:a.Name,c:[]}}$.each(e,function(e,t){var i=l[t.PID];i&&i.c.push({d:t.ID,n:t.Name})}),$.each(t,function(e,t){var i=s[t.PID];i&&i.c.push(l[t.ID])}),$.each(r,function(e,t){var i=s[t.ID];i&&n.push(i)}),router.$("#pylon-app-curvereport-deviceer .selector").html('<div class="selected-val"></div><div class="selected-val"></div><div class="selected-val"></div>'),u.deviceer=bui.levelselect({data:n,title:"筛选范围",trigger:"#pylon-app-curvereport-deviceer .selected-val",level:3,field:{name:"n",value:"d",data:["c","a"]}})}!1===isNull(u.deviceer)&&u.deviceer.on("lastchange",function(e,t,i){var n=this.value();if(getAppAuthType()===$ssh.Station){if(2<=n.length)return o(parseInt(n[1].value)),!0}else if(3<=n.length)return o(parseInt(n[2].value)),!0;o()})}(e)},function(e){warning(e.message)},function(){u.loading.hide()})),!0===isNull(this.deviceor)&&(this.deviceor=router.$("#pylon-app-curvereport-deviceer"),this.deviceor.on("click",function(){u.deviceer.show()})),!0===isNull(this.signaler)&&(this.signaler=bui.select({trigger:"#pylon-app-curvereport-signal",title:"信号列表",type:"radio",height:"60%",autoClose:!0,data:[],placeholder:"请选择"})),!0===isNull(this.starter)&&(this.starter=bui.pickerdate({bindValue:!0,handle:"#pylon-app-curvereport-start",formatValue:"yyyy-MM-dd hh:mm:ss",value:bui.date.format(new Date,"yyyy-MM-dd")})),!0===isNull(this.ender)&&(this.ender=bui.pickerdate({bindValue:!0,handle:"#pylon-app-curvereport-end",formatValue:"yyyy-MM-dd hh:mm:ss",value:new Date})),!0===isNull(this.submit)&&(this.submit=bui.btn("#pylon-app-curvereport-ok"),this.submit.submit(l,{text:"正在查询..."}))},u.load=function(){},u.dispose=function(){},u.init(),u});